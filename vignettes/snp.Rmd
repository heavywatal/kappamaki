---
title: "Simulate SNP pattern"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Simulate SNP pattern}
  %\VignetteEngine{knitr::rmarkdown}
---

```{r, setup-hidden}
#| include: false
knitr::opts_chunk$set(fig.alt = " ")
```

```{r, setup}
library(tekkamaki)
library(ggplot2)
grDevices::palette("Okabe-Ito")
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis",
  ggplot2.discrete.colour = grDevices::palette()[-1],
  ggplot2.discrete.fill = grDevices::palette()[-1]
)
```

## Generate a gene genealogy

```{r, run}
result = tekka("--seed 42 -y40 -K100 -r2 -l2 --sa 2,2 --sj 2,2")
samples = result$sample_family[[1L]]
segments = gather_segments(samples)
set.seed(666L)
genealogy = make_gene_genealogy(segments) |> print()
```

## Visualize the generated gene genealogy

```{r, plot}
#| fig-height: 8
#| fig-width: 10
plot(genealogy) +
  theme_void() +
  theme(legend.position = "top")
```

## Generate a SNP matrix

```{r, snp}
genealogy |> place_mutations(3L)
```

There is a shortcut to generate a SNP matrix from `sample_family`:

```{r, snp-shortcut}
make_snp(samples, ss = c(1L, 2L))
```
